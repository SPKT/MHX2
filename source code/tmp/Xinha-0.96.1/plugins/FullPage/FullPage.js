/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function FullPage(c){this.editor=c;var a=c.config;a.fullPage=true;var b=this;a.registerButton("FP-docprop",this._lc("Document properties"),c.imgURL("docprop.gif","FullPage"),false,function(d,e){b.buttonPress(d,e)});a.addToolbarElement(["separator","FP-docprop"],"separator",-1)}FullPage._pluginInfo={name:"FullPage",version:"1.0",developer:"Mihai Bazon",developer_url:"http://dynarch.com/mishoo/",c_owner:"Mihai Bazon",sponsor:"Thycotic Software Ltd.",sponsor_url:"http://thycotic.com",license:"htmlArea"};FullPage.prototype._lc=function(a){return Xinha._lc(a,"FullPage")};FullPage.prototype.buttonPress=function(b,a){var q=this;switch(a){case"FP-docprop":var j=b._doc;var m=j.getElementsByTagName("link");var l="";var p="";var e="";var k="";var c="";for(var d=m.length;--d>=0;){var g=m[d];if(/stylesheet/i.test(g.rel)){if(/alternate/i.test(g.rel)){p=g.href}else{l=g.href}}}var f=j.getElementsByTagName("meta");for(var d=f.length;--d>=0;){var o=f[d];if(/content-type/i.test(o.httpEquiv)){r=/^text\/html; *charset=(.*)$/i.exec(o.content);c=r[1]}else{if((/keywords/i.test(o.name))||(/keywords/i.test(o.id))){e=o.content}else{if((/description/i.test(o.name))||(/description/i.test(o.id))){k=o.content}}}}var h=j.getElementsByTagName("title")[0];h=h?h.innerHTML:"";var n={f_doctype:b.doctype,f_title:h,f_body_bgcolor:Xinha._colorToRgb(j.body.style.backgroundColor),f_body_fgcolor:Xinha._colorToRgb(j.body.style.color),f_base_style:l,f_alt_style:p,f_charset:c,f_keywords:e,f_description:k,editor:b};b._popupDialog("plugin://FullPage/docprop",function(i){q.setDocProp(i)},n);break}};FullPage.prototype.setDocProp=function(l){var j="";var u=this.editor._doc;var d=u.getElementsByTagName("head")[0];var b=u.getElementsByTagName("link");var a=u.getElementsByTagName("meta");var m=null;var o=null;var c=null;var f=null;var g=null;var p=null;for(var n=b.length;--n>=0;){var e=b[n];if(/stylesheet/i.test(e.rel)){if(/alternate/i.test(e.rel)){o=e}else{m=e}}}for(var n=a.length;--n>=0;){var h=a[n];if(/content-type/i.test(h.httpEquiv)){r=/^text\/html; *charset=(.*)$/i.exec(h.content);c=r[1];f=h}else{if((/keywords/i.test(h.name))||(/keywords/i.test(h.id))){g=h}else{if((/description/i.test(h.name))||(/description/i.test(h.id))){p=h}}}}function k(v){var i=u.createElement("link");i.rel=v?"alternate stylesheet":"stylesheet";d.appendChild(i);return i}function q(i,v,w){var x=u.createElement("meta");if(i!=""){x.httpEquiv=i}if(v!=""){x.name=v}if(v!=""){x.id=v}x.content=w;d.appendChild(x);return x}if(!m&&l.f_base_style){m=k(false)}if(l.f_base_style){m.href=l.f_base_style}else{if(m){d.removeChild(m)}}if(!o&&l.f_alt_style){o=k(true)}if(l.f_alt_style){o.href=l.f_alt_style}else{if(o){d.removeChild(o)}}if(f){d.removeChild(f);f=null}if(!f&&l.f_charset){f=q("Content-Type","","text/html; charset="+l.f_charset)}if(!g&&l.f_keywords){g=q("","keywords",l.f_keywords)}else{if(l.f_keywords){g.content=l.f_keywords}else{if(g){d.removeChild(g)}}}if(!p&&l.f_description){p=q("","description",l.f_description)}else{if(l.f_description){p.content=l.f_description}else{if(p){d.removeChild(p)}}}for(var n in l){var t=l[n];switch(n){case"f_title":var s=u.getElementsByTagName("title")[0];if(!s){s=u.createElement("title");d.appendChild(s)}else{while(node=s.lastChild){s.removeChild(node)}}if(!Xinha.is_ie){s.appendChild(u.createTextNode(t))}else{u.title=t}break;case"f_doctype":this.editor.setDoctype(t);break;case"f_body_bgcolor":u.body.style.backgroundColor=t;break;case"f_body_fgcolor":u.body.style.color=t;break}}};