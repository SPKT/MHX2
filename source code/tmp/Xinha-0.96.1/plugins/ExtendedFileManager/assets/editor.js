/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
var current_action=null;var actions=["crop","scale","rotate","measure","save"];var orginal_width=null,orginal_height=null;function toggle(a){if(current_action!=a){for(var b in actions){if(actions[b]!=a){var d=document.getElementById("tools_"+actions[b]);d.style.display="none";var g=document.getElementById("icon_"+actions[b]);g.className=""}}current_action=a;var d=document.getElementById("tools_"+a);d.style.display="block";var g=document.getElementById("icon_"+a);g.className="iconActive";var l=document.getElementById("indicator_image");l.src="img/"+a+".gif";editor.setMode(current_action);if(a=="scale"){var f=editor.window.document.getElementById("theImage");orginal_width=f._width;orginal_height=f._height;var j=document.getElementById("sw");j.value=orginal_width;var c=document.getElementById("sh");c.value=orginal_height}if(a=="save"){var e=document.getElementById("save_format");var k=document.getElementById("save_filename").value.match(/\.(gif|png|jpe?g)/i)[1].toLowerCase();switch(k){case"png":e.selectedIndex="3";break;case"gif":e.selectedIndex="4";break;default:e.selectedIndex="0";break}e.onchange()}}}function toggleMarker(){var a=document.getElementById("markerImg");if(a!=null&&a.src!=null){if(a.src.indexOf("t_black.gif")>=0){a.src="img/t_white.gif"}else{a.src="img/t_black.gif"}editor.toggleMarker()}}function toggleConstraints(){var a=document.getElementById("scaleConstImg");var b=document.getElementById("constProp");if(a!=null&&a.src!=null){if(a.src.indexOf("unlocked2.gif")>=0){a.src="img/islocked2.gif";b.checked=true;checkConstrains("width")}else{a.src="img/unlocked2.gif";b.checked=false}}}function checkConstrains(f){var b=document.getElementById("constProp");if(b.checked){var a=document.getElementById("sw");var d=a.value;var c=document.getElementById("sh");var e=c.value;if(orginal_width>0&&orginal_height>0){if(f=="width"&&d>0){c.value=parseInt((d/orginal_width)*orginal_height)}else{if(f=="height"&&e>0){a.value=parseInt((e/orginal_height)*orginal_width)}}}}updateMarker("scale")}function updateMarker(f){if(f=="crop"){var e=document.getElementById("cx");var d=document.getElementById("cy");var g=document.getElementById("cw");var b=document.getElementById("ch");editor.setMarker(parseInt(e.value),parseInt(d.value),parseInt(g.value),parseInt(b.value))}else{if(f=="scale"){var a=document.getElementById("sw");var c=document.getElementById("sh");editor.setMarker(0,0,parseInt(a.value),parseInt(c.value))}}}function rotateSubActionSelect(b){var c=b.options[b.selectedIndex].value;var a=document.getElementById("rotate_preset_select");var d=document.getElementById("flip");var e=document.getElementById("ra").parentNode;switch(c){case"rotate":a.style.display="";d.style.display="none";e.style.display="";break;case"flip":a.style.display="none";d.style.display="";e.style.display="none";break}}function rotatePreset(a){var b=a.options[a.selectedIndex].value;if(b.length>0&&parseInt(b)!=0){var c=document.getElementById("ra");c.value=parseInt(b)}}function updateFormat(a){var c=a.options[a.selectedIndex].value;var b=c.split(",");if(b[0]!="jpeg"){document.getElementById("slider").style.display="none"}else{document.getElementById("slider").style.display="inline"}if(b.length>1){updateSlider(parseInt(b[1]))}}function zoom(){var a=editor.window.document.getElementById("theImage");var b=document.getElementById("zoom").value;a.width=a._width*parseInt(b,10)/100;a.height=a._height*parseInt(b,10)/100;editor.reset();editor.pic_width=null;editor.pic_height=null}function addEvent(d,a,b){if(d.addEventListener){d.addEventListener(a,b,true);return true}else{if(d.attachEvent){var c=d.attachEvent("on"+a,b);return c}else{return false}}}var init=function(){if(window.opener){__xinha_dlg_init();__dlg_translate("ExtendedFileManager")}addEvent(window,"resize",winOnResize);try{window.moveTo(0,0)}catch(a){}window.resizeTo(window.screen.availWidth,window.screen.availHeight);winOnResize()};function winOnResize(){if(typeof editor.reset=="function"&&typeof editor.ant!="undefined"){editor.reset()}var a=Xinha.viewportSize(window);document.getElementById("contents").style.height=a.y-parseInt(document.getElementById("indicator").offsetHeight,10)-5+"px"}Xinha.addOnloadHandler(init,window);