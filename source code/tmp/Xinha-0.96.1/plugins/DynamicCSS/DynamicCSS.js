/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function DynamicCSS(c,e){this.editor=c;var a=c.config;var b=this;var g=null;var d=null;var f={id:"DynamicCSS-class",tooltip:this._lc("Choose stylesheet"),options:{"":""},action:function(h){b.onSelect(h,this)},refresh:function(h){b.updateValue(h,this)}};a.registerDropdown(f);a.addToolbarElement(["T[CSS]","DynamicCSS-class","separator"],"formatblock",-1)}DynamicCSS.parseStyleSheet=function(a){iframe=a._iframe.contentWindow.document;cssArray=DynamicCSS.cssArray;if(!cssArray){cssArray=new Array()}for(i=0;i<iframe.styleSheets.length;i++){if(iframe.styleSheets[i].title=="XinhaInternalCSS"){continue}if(Xinha.is_gecko){try{cssArray=DynamicCSS.applyCSSRule(iframe.styleSheets[i].cssRules,cssArray)}catch(b){}}else{try{if(iframe.styleSheets[i].rules){cssArray=DynamicCSS.applyCSSRule(iframe.styleSheets[i].rules,cssArray)}if(iframe.styleSheets[i].imports){for(j=0;j<iframe.styleSheets[i].imports.length;j++){cssArray=DynamicCSS.applyCSSRule(iframe.styleSheets[i].imports[j].rules,cssArray)}}}catch(b){}}}DynamicCSS.cssArray=cssArray};DynamicCSS.applyCSSRule=function(b,a){for(rule in b){if(typeof b[rule]=="function"){continue}if(b[rule].selectorText){if(b[rule].selectorText.search(/:+/)==-1){cssElements=b[rule].selectorText.split(",");for(k=0;k<cssElements.length;k++){cssElement=cssElements[k].split(".");tagName=cssElement[0].toLowerCase().trim();className=cssElement[1];if(!tagName){tagName="all"}if(!a[tagName]){a[tagName]=new Array()}if(className){if(tagName=="all"){cssName=className}else{cssName="<"+className+">"}}else{className="none";if(tagName=="all"){cssName=Xinha._lc("Default","DynamicCSS")}else{cssName="<"+Xinha._lc("Default","DynamicCSS")+">"}}a[tagName][className]=cssName;DynamicCSS.cssLength++}}}else{if(b[rule].styleSheet){a=DynamicCSS.applyCSSRule(b[rule].styleSheet.cssRules,a)}}}return a};DynamicCSS._pluginInfo={name:"DynamicCSS",version:"1.5.2",developer:"Holger Hees",developer_url:"http://www.systemconcept.de/",c_owner:"Holger Hees",sponsor:"System Concept GmbH",sponsor_url:"http://www.systemconcept.de/",license:"htmlArea"};DynamicCSS.prototype._lc=function(a){return Xinha._lc(a,"DynamicCSS")};DynamicCSS.prototype.onSelect=function(c,f){var e=c._toolbarObjects[f.id];var d=e.element.selectedIndex;var b=e.element.value;var a=c.getParentElement();if(b!="none"){a.className=b;DynamicCSS.lastClass=b}else{if(Xinha.is_gecko){a.removeAttribute("class")}else{a.removeAttribute("className")}}c.updateToolbar()};DynamicCSS.prototype.reparseTimer=function(b,c,a){if(DynamicCSS.parseCount<9){setTimeout(function(){DynamicCSS.cssLength=0;DynamicCSS.parseStyleSheet(b);if(DynamicCSS.cssOldLength!=DynamicCSS.cssLength){DynamicCSS.cssOldLength=DynamicCSS.cssLength;DynamicCSS.lastClass=null;a.updateValue(b,c)}a.reparseTimer(b,c,a)},DynamicCSS.parseCount*1000);DynamicCSS.parseCount=DynamicCSS.parseCount*2}};DynamicCSS.prototype.updateValue=function(b,e){cssArray=DynamicCSS.cssArray;if(!cssArray){DynamicCSS.cssLength=0;DynamicCSS.parseStyleSheet(b);cssArray=DynamicCSS.cssArray;DynamicCSS.cssOldLength=DynamicCSS.cssLength;DynamicCSS.parseCount=1;this.reparseTimer(b,e,this)}var h=b.getParentElement();var f=h.tagName.toLowerCase();var a=h.className;if(this.lastTag!=f||this.lastClass!=a){this.lastTag=f;this.lastClass=a;var l=b._toolbarObjects[e.id].element;while(l.length>0){l.options[l.length-1]=null}l.options[0]=new Option(this._lc("Default"),"none");if(cssArray){if(f!="body"||b.config.fullPage){if(cssArray[f]){for(cssClass in cssArray[f]){if(typeof cssArray[f][cssClass]!="string"){continue}if(cssClass=="none"){l.options[0]=new Option(cssArray[f][cssClass],cssClass)}else{l.options[l.length]=new Option(cssArray[f][cssClass],cssClass)}}}if(cssArray.all){for(cssClass in cssArray.all){if(typeof cssArray.all[cssClass]!="string"){continue}l.options[l.length]=new Option(cssArray.all[cssClass],cssClass)}}}else{if(cssArray[f]&&cssArray[f]["none"]){l.options[0]=new Option(cssArray[f]["none"],"none")}}}l.selectedIndex=0;if(typeof a!="undefined"&&/\S/.test(a)){var g=l.options;for(var d=g.length;--d>=0;){var c=g[d];if(a==c.value){l.selectedIndex=d;break}}if(l.selectedIndex==0){l.options[l.length]=new Option(this._lc("Undefined"),a);l.selectedIndex=l.length-1}}if(l.length>1){l.disabled=false}else{l.disabled=true}}};