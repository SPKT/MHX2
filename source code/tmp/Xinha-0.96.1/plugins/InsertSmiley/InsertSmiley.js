/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
InsertSmiley._pluginInfo={name:"InsertSmiley",version:"2.0",developer:"V 1.0 Ki Master George, V2.0 James Sleeman",developer_url:"http://www.gogo.co.nz/",c_owner:"Ki Master George, James Sleeman",sponsor:"Gogo Internet Services",sponsor_url:"http://www.gogo.co.nz/",license:"htmlArea"};Xinha.Config.prototype.InsertSmiley={smileys:""};Xinha.loadStyle("dialog.css","InsertSmiley");function InsertSmiley(c){this.editor=c;this.smileys=false;this.dialog=false;var a=c.config;var b=this;a.registerButton({id:"insertsmiley",tooltip:this._lc("Insert Smiley"),image:c.imgURL("ed_smiley.gif","InsertSmiley"),textMode:false,action:function(d){b.buttonPress(d)}});a.addToolbarElement("insertsmiley","inserthorizontalrule",1)}InsertSmiley.prototype.onGenerateOnce=function(){if(this.editor.config.InsertSmiley.smileyURL){var a=[];var c=Xinha._geturlcontent(Xinha.getPluginDir("InsertSmiley")+"/smileys.txt");var d=this.editor.config.InsertSmiley.smileyURL;c=c.match(/^.+$/mg);for(var b=0;b<c.length;b++){a[a.length]={title:c[b],src:d+encodeURIComponent(c[b])}}this.editor.config.InsertSmiley.smileys=a}this.loadAssets()};InsertSmiley.prototype._lc=function(a){return Xinha._lc(a,"InsertSmiley")};InsertSmiley.prototype.loadAssets=function(){var self=this;if(self.loading){return}if(typeof this.editor.config.InsertSmiley.smileys!="string"){this.smileys=this.editor.config.InsertSmiley.smileys;this.smiley_base=_editor_url}else{var smileys_def=this.editor.config.InsertSmiley.smileys?this.editor.config.InsertSmiley.smileys:(Xinha.getPluginDir("InsertSmiley")+"/smileys/smileys.js");Xinha._getback(smileys_def,function(sm){self.smileys=eval(sm);self.smileys_base=smileys_def.replace(/\/[^\/]+(\?.*)?$/,"/")})}Xinha._getback(Xinha.getPluginDir("InsertSmiley")+"/dialog.html",function(html){self.makeDialog(html)})};InsertSmiley.prototype.makeDialog=function(f){var c=this;if(!this.smileys){window.setTimeout(function(){c.makeDialog(f)},1000);return}var d=new Xinha.Dialog(this.editor,f,"InsertSmiley",{width:155,height:100},{modal:false});var h;var g;var b;for(var e=0;e<this.smileys.length;e++){h=this.smileys[e].src.match(/^(([a-zA-Z]+:\/\/)|\/)/)?this.smileys[e].src:this.smileys_base+this.smileys[e].src;g=document.createElement("img");g.src=h;g.alt=d._lc(this.smileys[e].title);g.style.border="none";b=document.createElement("a");b.href="javascript:void(0);";b.smiley_src=h;b.title=d._lc(this.smileys[e].title);Xinha.addDom0Event(b,"click",function(a){c.editor.insertHTML('<img src="'+this.smiley_src+'" alt="'+this.title+'" />');Xinha._stopEvent(window.event?event:a);return false});b.appendChild(g);d.getElementById("smileys").appendChild(b);b=null;g=null;h=null}this.dialog=d;return true};InsertSmiley.prototype.buttonPress=function(a){if(this.dialog){this.dialog.show()}else{}return};