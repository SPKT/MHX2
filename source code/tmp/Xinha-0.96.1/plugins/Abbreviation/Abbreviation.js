/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function Abbreviation(c){this.editor=c;var a=c.config;var b=this;a.registerButton({id:"abbreviation",tooltip:Xinha._lc("Abbreviation","Abbreviation"),image:c.imgURL("ed_abbreviation.gif","Abbreviation"),textMode:false,action:function(d){b.show()}});a.addToolbarElement("abbreviation","inserthorizontalrule",1)}Abbreviation._pluginInfo={name:"Abbreviation",version:"1.0",developer:"Udo Schmal",developer_url:"",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de/",c_owner:"Udo Schmal & Schaffrath-NeueMedien",license:"htmlArea"};Abbreviation.prototype.fillText=function(){var editor=this.editor;var text=this.html.toUpperCase();var abbr=Xinha.getPluginDir(this.constructor.name)+"/abbr/"+_editor_lang+".js";var abbrData=Xinha._geturlcontent(abbr);if(abbrData){eval("abbrObj = "+abbrData);if(abbrObj!=""){var dest=this.dialog.getElementById("title");dest.value=this.title||"";for(var i in abbrObj){same=(i.toUpperCase()==text);if(same){dest.value=abbrObj[i]}}}}};Abbreviation.prototype.onGenerateOnce=function(b){this.editor.addEditorStylesheet(Xinha.getPluginDir("Abbreviation")+"/abbreviation.css");this.methodsReady=true;var a=Abbreviation;Xinha._getback(Xinha.getPluginDir("Abbreviation")+"/dialog.html",function(c){a.html=c;a.dialogReady=true})};Abbreviation.prototype.OnUpdateToolbar=function(a){if(!(Abbreviation.dialogReady&&Abbreviation.methodsReady)){this.editor._toolbarObjects.Abbreviation.state("enabled",false)}else{this.onUpdateToolbar=null}};Abbreviation.prototype.prepareDialog=function(d){var b=this;var a=this.editor;var c=this.dialog=new Xinha.Dialog(a,Abbreviation.html,"Xinha",{width:260,height:140});c.getElementById("ok").onclick=function(){b.apply()};c.getElementById("delete").onclick=function(){b.ondelete()};c.getElementById("cancel").onclick=function(){b.dialog.hide()};this.dialogReady=true};Abbreviation.prototype.show=function(c){var c=this.editor;this.html=c.getSelectedHTML();if(!this.dialog){this.prepareDialog()}var b=this;var f=c._doc;var e=c._getSelection();var a=c._createRange(e);var d=c._activeElement(e);if(!(d!=null&&d.tagName.toLowerCase()=="abbr")){d=c._getFirstAncestor(e,"abbr")}this.abbr=d;if(d){this.title=d.title}this.fillText();this.dialog.getElementById("inputs").onsubmit=function(){b.apply();return false};this.dialog.show();this.dialog.getElementById("title").select()};Abbreviation.prototype.apply=function(){var a=this.editor;var f=a._doc;var b=this.abbr;var c=this.html;var h=this.dialog.hide();if(h){var g=h.title;if(g==""||g==null){if(b){var i=b.innerHTML;b.parentNode.removeChild(b);a.insertHTML(i)}return}try{if(!b){b=f.createElement("abbr");b.title=g;b.innerHTML=c;if(Xinha.is_ie){range.pasteHTML(b.outerHTML)}else{a.insertNodeAtSelection(b)}}else{b.title=g}}catch(d){}}};Abbreviation.prototype.ondelete=function(){this.dialog.getElementById("title").value="";this.apply()};