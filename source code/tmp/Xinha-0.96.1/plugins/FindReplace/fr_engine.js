/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
var FindReplace=window.opener.FindReplace;var editor=FindReplace.editor;var is_mo=window.opener.Xinha.is_gecko;var tosearch="";var pater=null;var buffer=null;var matches=0;var replaces=0;var fr_spans=new Array();function _lc(a){return(window.opener.Xinha._lc(a,"FindReplace"))}function execSearch(params){var ihtml=editor._doc.body.innerHTML;if(buffer==null){buffer=ihtml}if(params.fr_pattern!=tosearch){if(tosearch!=""){clearDoc()}tosearch=params.fr_pattern}if(matches==0){er=params.fr_words?"/(?!<[^>]*)(\\b"+params.fr_pattern+"\\b)(?![^<]*>)/g":"/(?!<[^>]*)("+params.fr_pattern+")(?![^<]*>)/g";if(!params.fr_matchcase){er+="i"}pater=eval(er);var tago="<span id=frmark>";var tagc="</span>";var newHtml=ihtml.replace(pater,tago+"$1"+tagc);editor.setHTML(newHtml);var getallspans=editor._doc.body.getElementsByTagName("span");for(var i=0;i<getallspans.length;i++){if(/^frmark/.test(getallspans[i].id)){fr_spans.push(getallspans[i])}}}spanWalker(params.fr_pattern,params.fr_replacement,params.fr_replaceall)}function spanWalker(a,d,b){var g=false;clearMarks();for(var c=matches;c<fr_spans.length;c++){var h=fr_spans[c];g=true;if(!(/[0-9]$/.test(h.id))){matches++;disab("fr_clear",false);h.id="frmark_"+matches;h.style.color="white";h.style.backgroundColor="highlight";h.style.fontWeight="bold";h.scrollIntoView(false);if(/\w/.test(d)){if(b||confirm(_lc("Substitute this occurrence?"))){h.firstChild.replaceData(0,h.firstChild.data.length,d);replaces++;disab("fr_undo",false)}if(b){clearMarks();continue}}break}}var f=(c>=fr_spans.length-1);if(f||!g){var e=_lc("Done")+":\n\n";if(matches>0){if(matches==1){e+=matches+" "+_lc("found item")}else{e+=matches+" "+_lc("found items")}if(replaces>0){if(replaces==1){e+=",\n"+replaces+" "+_lc("replaced item")}else{e+=",\n"+replaces+" "+_lc("replaced items")}}hiliteAll();disab("fr_hiliteall",false)}else{e+='"'+a+'" '+_lc("not found")}alert(e+".")}}function clearDoc(){var a=editor._doc.body.innerHTML;var b=/(<span\s+[^>]*id=.?frmark[^>]*>)([^<>]*)(<\/span>)/gi;editor._doc.body.innerHTML=a.replace(b,"$2");pater=null;tosearch="";fr_spans=new Array();matches=0;replaces=0;disab("fr_hiliteall,fr_clear",true)}function clearMarks(){var d=editor._doc.body.getElementsByTagName("span");for(var b=0;b<d.length;b++){var c=d[b];if(/^frmark/.test(c.id)){var a=editor._doc.getElementById(c.id).style;a.backgroundColor="";a.color="";a.fontWeight=""}}}function hiliteAll(){var d=editor._doc.body.getElementsByTagName("span");for(var b=0;b<d.length;b++){var c=d[b];if(/^frmark/.test(c.id)){var a=editor._doc.getElementById(c.id).style;a.backgroundColor="highlight";a.color="white";a.fontWeight="bold"}}}function resetContents(){if(buffer==null){return}var a=editor._doc.body.innerHTML;editor._doc.body.innerHTML=buffer;buffer=a}function disab(b,d){var c=b.split(/[,; ]+/);for(var a=0;a<c.length;a++){document.getElementById(c[a]).disabled=d}};