/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
MootoolsFileManager.prototype.OpenFileManager=function(d){var c=this.editor;var g=null;var b=this;if(typeof d=="undefined"){d=this.editor.getParentElement();if(d){if(/^img$/i.test(d.tagName)){d=d.parentNode}if(!/^a$/i.test(d.tagName)){d=null}}}if(!d){var f=c.getSelection();var a=c.createRange(f);var e=0;if(Xinha.is_ie){if(f.type=="Control"){e=a.length}else{e=a.compareEndPoints("StartToEnd",a)}}else{e=a.compareBoundaryPoints(a.START_TO_END,a)}if(e==0){alert(Xinha._lc("You must select some text before making a new link.","MootoolsFileManager"));return}g={f_href:"",f_title:"",f_target:"",f_type:"",baseHref:c.config.baseHref}}else{g={f_href:Xinha.is_ie?d.href:d.getAttribute("href"),f_title:d.title,f_target:d.target,f_type:d.type?d.type:"",baseHref:c.config.baseHref}}this.current_link=d;this.current_attributes=g;if(!this.FileManagerWidget){this.FileManagerWidget=new FileManager({url:this.editor.config.MootoolsFileManager.backend+"__function=file-manager&",assetBasePath:Xinha.getPluginDir("MootoolsFileManager")+"/mootools-filemanager/Assets",language:_editor_lang,selectable:true,uploadAuthData:this.editor.config.MootoolsFileManager.backend_data,onComplete:function(i,h){b.FileManagerReturn(i,h)},onHide:function(){if(this.swf&&this.swf.box){this.swf.box.style.display="none"}},onShow:function(){if(this.swf&&this.swf.box){this.swf.box.style.display=""}},onDetails:function(h){this.info.adopt(b.FileManagerAttributes(h));return true},onHidePreview:function(){$(b.FileManagerAttributes().table).dispose();return true}})}this.FileManagerWidget.show()};MootoolsFileManager.prototype.FileManagerReturn=function(k,f){var c=this.editor;var j=this.current_link;var g=this.FileManagerAttributes();g.f_href=k;if(!j){try{c._doc.execCommand("createlink",false,g.f_href);j=c.getParentElement();var d=c.getSelection();var h=c.createRange(d);if(!Xinha.is_ie){j=h.startContainer;if(!/^a$/i.test(j.tagName)){j=j.nextSibling;if(j==null){j=h.startContainer.parentNode}}}}catch(i){}}else{var b=g.f_href.trim();c.selectNodeContents(j);if(b==""){c._doc.execCommand("unlink",false,null);c.updateToolbar();return false}else{j.href=b}}if(!(j&&/^a$/i.test(j.tagName))){return false}j.type=g.f_type.trim();j.target=g.f_target.trim();j.title=g.f_title.trim();c.selectNodeContents(j);c.updateToolbar()};MootoolsFileManager.prototype.FileManagerAttributes=function(b){var a=this;a._LastFileDetails=b;function d(f){var h=a._FileManagerAttributesTable.getElementsByTagName("input");for(var g=0;g<h.length;g++){if(h[g].name==f){return h[g]}}var h=a._FileManagerAttributesTable.getElementsByTagName("select");for(var g=0;g<h.length;g++){if(h[g].name==f){return h[g]}}return null}function c(e,g){for(var f=0;f<d(e).options.length;f++){if(d(e).options[f].value==g){d(e).selectedIndex=f;return true}}return false}if(!this._FileManagerAttributesTable){this._FileManagerAttributesTable=(function(){var e=document.createElement("div");var i=document.createElement("h2");i.appendChild(document.createTextNode("Link Attributes"));e.appendChild(i);var m=document.createElement("table");e.appendChild(m);m.className="filemanager-extended-options";var h=m.appendChild(document.createElement("tbody"));var j=h.appendChild(document.createElement("tr"));var f=j.appendChild(document.createElement("th"));var l=f.appendChild(document.createTextNode("Title:"));var g=j.appendChild(document.createElement("td"));var k=g.appendChild(document.createElement("input"));g.colSpan=6;k.name="f_title";k.type="text";f.className=g.className="filemanager-f_title";var j=h.appendChild(document.createElement("tr"));var f=j.appendChild(document.createElement("th"));var l=f.appendChild(document.createTextNode("Type:"));var g=j.appendChild(document.createElement("td"));var k=g.appendChild(document.createElement("input"));g.colSpan=6;k.name="f_type";k.type="text";f.className=g.className="filemanager-f_type";var j=h.appendChild(document.createElement("tr"));var f=j.appendChild(document.createElement("th"));var l=f.appendChild(document.createTextNode("Open In:"));var g=j.appendChild(document.createElement("td"));g.colSpan=2;var k=g.appendChild(document.createElement("select"));k.name="f_target";k.options[0]=new Option("");k.options[1]=new Option("New Window","_blank");k.options[2]=new Option("Top Frame","_top");k.options[3]=new Option("Other Frame:","");Xinha._addEvent(k,"change",function(){if(d("f_target").selectedIndex==3){d("f_otherTarget").style.visibility="visible"}else{d("f_otherTarget").style.visibility="hidden"}});var k=g.appendChild(document.createElement("input"));k.name="f_otherTarget";k.size=7;k.type="text";k.style.visibility="hidden";f.className=g.className="filemanager-f_target";return e})()}if(this.current_attributes){d("f_title").value=this.current_attributes.f_title;d("f_type").value=this.current_attributes.f_type;if(this.current_attributes.f_target){if(!c("f_target",this.current_attributes.f_target)){d("f_target").selectedIndex=3;d("f_otherTarget").value=this.current_attributes.f_target}else{d("f_otherTarget").value=""}}this.current_attributes=null}if(!b){var b={f_title:d("f_title").value,f_type:d("f_type").value,f_target:d("f_target").selectedIndex<3?d("f_target").options[d("f_target").selectedIndex].value:d("f_otherTarget").value,table:this._FileManagerAttributesTable};return b}if(b.mime){d("f_type").value=b.mime}d("f_target").style.visibility="";if(d("f_target").selectedIndex==3){d("f_otherTarget").style.visibility="visible"}else{d("f_otherTarget").style.visibility="hidden"}return this._FileManagerAttributesTable};