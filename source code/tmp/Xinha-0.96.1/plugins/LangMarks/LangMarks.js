/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function LangMarks(c,e){this.editor=c;var a=c.config;var b=this;var g={};g[this._lc("&mdash; language &mdash;")]="";if(!a.LangMarks.languages){Xinha.debugMsg("Warning: Old style LangMarks configuration detected, please update your LangMarks configuration.");var d={languages:[],attributes:Xinha.Config.prototype.attributes};for(var f in a.LangMarks){if(typeof f!="string"){continue}d.languages.push({name:f,code:a.LangMarks[f]})}a.LangMarks=d}for(var f=0;f<a.LangMarks.languages.length;f++){g[this._lc(a.LangMarks.languages[f].name)]=a.LangMarks.languages[f].code}a.registerDropdown({id:"langmarks",tooltip:this._lc("language select"),options:g,action:function(h){b.onSelect(h,this)},refresh:function(h){b.updateValue(h,this)}});a.addToolbarElement("langmarks","inserthorizontalrule",1)}LangMarks._pluginInfo={name:"LangMarks",version:"1.0",developer:"Udo Schmal",developer_url:"",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de/",c_owner:"Udo Schmal & Schaffrath NeueMedien",license:"htmlArea"};Xinha.Config.prototype.LangMarks={languages:[{name:"Greek",code:"el"},{name:"English",code:"en"},{name:"French",code:"fr"},{name:"Latin",code:"la"}],attributes:["lang","xml:lang"]};LangMarks.prototype._lc=function(a){return Xinha._lc(a,"LangMarks")};LangMarks.prototype.onGenerate=function(){this.editor.addEditorStylesheet(Xinha.getPluginDir("LangMarks")+"/lang-marks.css")};LangMarks.prototype.onSelect=function(c,f,b,a){var l=c._toolbarObjects[f.id];var h=l.element.selectedIndex;var d=l.element.value;var n=c.getParentElement();var m=true;var k=(n&&n.tagName.toLowerCase()=="span");var j=(b&&a&&n&&n.tagName.toLowerCase()==b);if(j){n.className="haslang";n.lang=d;for(var e=0;e<this.editor.config.LangMarks.attributes.length;e++){n.setAttribute(this.editor.config.LangMarks.attributes[e],d)}c.updateToolbar();return}if(k&&h==0&&!/\S/.test(n.style.cssText)){while(n.firstChild){n.parentNode.insertBefore(n.firstChild,n)}n.parentNode.removeChild(n);c.updateToolbar();return}if(k){if(n.childNodes.length==1){n.className="haslang";n.lang=d;for(var e=0;e<this.editor.config.LangMarks.attributes.length;e++){n.setAttribute(this.editor.config.LangMarks.attributes[e],d)}m=false;c.updateToolbar()}}if(m){var g="";for(var e=0;e<this.editor.config.LangMarks.attributes.length;e++){g+=" "+this.editor.config.LangMarks.attributes[e]+'="'+d+'"'}c.surroundHTML("<span"+g+' class="haslang">',"</span>")}};LangMarks.prototype.updateValue=function(a,f){var m=a._toolbarObjects[f.id].element;var l=a.getAllAncestors();var k;var b;for(var e=0;e<l.length;e++){for(var d=0;d<a.config.LangMarks.attributes.length;d++){if(l[e].getAttribute(this.editor.config.LangMarks.attributes[d])){k=l[e];b=l[e].getAttribute(this.editor.config.LangMarks.attributes[d])}}}if(k){var g=m.options;var h=b;for(var e=g.length;--e>=0;){var c=g[e];if(h==c.value){m.selectedIndex=e;return}}}else{m.selectedIndex=0}};