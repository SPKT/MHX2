/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function CharCounter(a){this.editor=a;this._Chars=0;this._Words=0;this._HTML=0;this.onKeyPress=this.__onKeyPress}Xinha.Config.prototype.CharCounter={showChar:true,showWord:true,showHtml:true,separator:" | ",maxHTML:-1};CharCounter._pluginInfo={name:"CharCounter",version:"1.31",developer:"Udo Schmal",developer_url:"http://www.schaffrath-neuemedien.de",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de",c_owner:"Udo Schmal & L.N.Schaffrath NeueMedien",license:"htmlArea"};CharCounter.prototype._lc=function(a){return Xinha._lc(a,"CharCounter")};CharCounter.prototype.onGenerateOnce=function(){var b=this;if(this.charCount==null){var a=b.editor.registerStatusWidget("CharCounter",["wysiwyg"]);this.charCount=a}};CharCounter.prototype.__onKeyPress=function(b){if((b.keyCode!=8)&&(b.keyCode!=46)){if(this.editor.config.CharCounter.maxHTML!=-1){var a=this.editor.getHTML();if(a.length>=this.editor.config.CharCounter.maxHTML){Xinha._stopEvent(b);return true}}}};CharCounter.prototype._updateCharCount=function(){var d=this.editor;var c=d.config;var b=d.getHTML();var e=new Array();if(c.CharCounter.showHtml){e[e.length]=this._lc("HTML")+": "+b.length}this._HTML=b.length;if(c.CharCounter.showWord||c.CharCounter.showChar){b=b.replace(/<\/?\s*!--[^-->]*-->/gi,"");b=b.replace(/<(.+?)>/g,"");b=b.replace(/&nbsp;/gi," ");b=b.replace(/([\n\r\t])/g," ");b=b.replace(/(  +)/g," ");b=b.replace(/&(.*);/g," ");b=b.replace(/^\s*|\s*$/g,"")}if(c.CharCounter.showWord){this._Words=0;for(var a=0;a<b.length;a++){if(b.charAt(a)==" "){this._Words++}}if(this._Words>=1){this._Words++}e[e.length]=this._lc("Words")+": "+this._Words}if(c.CharCounter.showChar){e[e.length]=this._lc("Chars")+": "+b.length;this._Chars=b.length}this.charCount.innerHTML=e.join(c.CharCounter.separator)};CharCounter.prototype.onUpdateToolbar=function(){this.charCount.innerHTML=this._lc("... in progress");if(this._timeoutID){window.clearTimeout(this._timeoutID)}var a=this;this._timeoutID=window.setTimeout(function(){a._updateCharCount()},1000)};