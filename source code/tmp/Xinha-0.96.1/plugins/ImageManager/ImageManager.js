/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function ImageManager(a){}ImageManager._pluginInfo={name:"ImageManager",version:"1.0",developer:"Xiang Wei Zhuo",developer_url:"http://www.zhuo.org/htmlarea/",license:"htmlArea"};Xinha.Config.prototype.ImageManager={backend:Xinha.getPluginDir("ImageManager")+"/backend.php?__plugin=ImageManager&",backend_data:null,backend_config:null,backend_config_hash:null,backend_config_secret_key_location:"Xinha:ImageManager"};Xinha.prototype._insertImage=function(f){var a=this;var g=null;if(typeof f=="undefined"){f=this.getParentElement();if(f&&!/^img$/i.test(f.tagName)){f=null}}if(f){g={f_url:Xinha.is_ie?f.src:f.src,f_alt:f.alt,f_border:f.style.borderWidth?f.style.borderWidth:f.border,f_align:f.align,f_padding:f.style.padding,f_margin:f.style.margin,f_width:f.width,f_height:f.height,f_backgroundColor:f.style.backgroundColor,f_borderColor:f.style.borderColor,f_hspace:f.hspace&&f.hspace!="-1"?parseInt(f.hspace):"",f_vspace:f.vspace&&f.vspace!="-1"?parseInt(f.vspace):""};function d(h){if(/ /.test(h)){var l=h.split(" ");var k=true;for(var j=1;j<l.length;j++){if(l[0]!=l[j]){k=false;break}}if(k){h=l[0]}}return h}g.f_border=d(g.f_border);g.f_padding=d(g.f_padding);g.f_margin=d(g.f_margin);function e(j){if(typeof j=="string"&&/, /.test.color){j=j.replace(/, /,",")}if(typeof j=="string"&&/ /.test.color){var l=j.split(" ");var h="";for(var k=0;k<l.length;k++){h+=Xinha._colorToRgb(l[k]);if(k+1<l.length){h+=" "}}return h}return Xinha._colorToRgb(j)}g.f_backgroundColor=e(g.f_backgroundColor);g.f_borderColor=e(g.f_borderColor)}var c=a.config.ImageManager.backend+"__function=manager";if(a.config.ImageManager.backend_config!=null){c+="&backend_config="+encodeURIComponent(a.config.ImageManager.backend_config);c+="&backend_config_hash="+encodeURIComponent(a.config.ImageManager.backend_config_hash);c+="&backend_config_secret_key_location="+encodeURIComponent(a.config.ImageManager.backend_config_secret_key_location)}if(a.config.ImageManager.backend_data!=null){for(var b in a.config.ImageManager.backend_data){c+="&"+b+"="+encodeURIComponent(a.config.ImageManager.backend_data[b])}}Dialog(c,function(l){if(!l){return false}var i=f;if(!i){if(Xinha.is_ie){var k=a._getSelection();var h=a._createRange(k);a._doc.execCommand("insertimage",false,l.f_url);i=h.parentElement();if(i.tagName.toLowerCase()!="img"){i=i.previousSibling}}else{i=document.createElement("img");i.src=l.f_url;a.insertNodeAtSelection(i)}}else{i.src=l.f_url}for(field in l){var j=l[field];switch(field){case"f_alt":i.alt=j;break;case"f_border":if(j.length){i.style.borderWidth=/[^0-9]/.test(j)?j:(parseInt(j)+"px");if(i.style.borderWidth&&!i.style.borderStyle){i.style.borderStyle="solid"}}else{i.style.borderWidth="";i.style.borderStyle=""}break;case"f_borderColor":i.style.borderColor=j;break;case"f_backgroundColor":i.style.backgroundColor=j;break;case"f_padding":if(j.length){i.style.padding=/[^0-9]/.test(j)?j:(parseInt(j)+"px")}else{i.style.padding=""}break;case"f_margin":if(j.length){i.style.margin=/[^0-9]/.test(j)?j:(parseInt(j)+"px")}else{i.style.margin=""}break;case"f_align":i.align=j;break;case"f_width":if(!isNaN(parseInt(j))){i.width=parseInt(j)}else{i.width=""}break;case"f_height":if(!isNaN(parseInt(j))){i.height=parseInt(j)}else{i.height=""}break;case"f_hspace":if(!isNaN(parseInt(j))){i.hspace=parseInt(j)}else{i.hspace=""}break;case"f_vspace":if(!isNaN(parseInt(j))){i.vspace=parseInt(j)}else{i.vspace=""}break}}},g)};