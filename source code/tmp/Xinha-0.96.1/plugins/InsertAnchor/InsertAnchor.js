/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function InsertAnchor(c){this.editor=c;var a=c.config;var b=this;this.placeholderImg='<img class="IA_placeholder" src="'+Xinha.getPluginDir("InsertAnchor")+'/img/placeholder.gif" />';a.registerButton({id:"insert-anchor",tooltip:this._lc("Insert Anchor"),image:c.imgURL("insert-anchor.gif","InsertAnchor"),textMode:false,action:function(){b.show()}});a.addToolbarElement("insert-anchor","createlink",1)}InsertAnchor._pluginInfo={name:"InsertAnchor",origin:"version: 1.0, by Andre Rabold, MR Printware GmbH, http://www.mr-printware.de",version:"2.0",developer:"Udo Schmal",developer_url:"http://www.schaffrath-neuemedien.de",c_owner:"Udo Schmal",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de",license:"htmlArea"};InsertAnchor.prototype._lc=function(a){return Xinha._lc(a,"InsertAnchor")};InsertAnchor.prototype.onGenerate=function(){this.editor.addEditorStylesheet(Xinha.getPluginDir("InsertAnchor")+"/insert-anchor.css")};InsertAnchor.prototype.inwardHtml=function(a){a=a.replace(/(<a[^>]*class="anchor"[^>]*>)/g,"$1"+this.placeholderImg);return a};InsertAnchor.prototype.outwardHtml=function(a){a=a.replace(/(<img[^>]*class="?IA_placeholder"?[^>]*>)/ig,"");return a};InsertAnchor.prototype.onGenerateOnce=function(){this._prepareDialog()};InsertAnchor.prototype._prepareDialog=function(){var b=this;var a=this.editor;if(!this.html){Xinha._getback(Xinha.getPluginDir("InsertAnchor")+"/dialog.html",function(c){b.html=c;b._prepareDialog()});return}this.dialog=new Xinha.Dialog(a,this.html,"InsertAnchor",{width:400});this.dialog.getElementById("ok").onclick=function(){b.apply()};this.dialog.getElementById("cancel").onclick=function(){b.dialog.hide()};this.ready=true};InsertAnchor.prototype.show=function(){if(!this.ready){var c=this;window.setTimeout(function(){c.show()},100);return}var b=this.editor;this.selectedHTML=b.getSelectedHTML();var d=b.getSelection();var a=b.createRange(d);this.a=b.activeElement(d);if(!(this.a!=null&&this.a.tagName.toLowerCase()=="a")){this.a=b._getFirstAncestor(d,"a")}if(this.a!=null&&this.a.tagName.toLowerCase()=="a"){inputs={name:this.a.id}}else{inputs={name:""}}this.dialog.show(inputs);this.dialog.getElementById("name").focus()};InsertAnchor.prototype.apply=function(){var b=this.editor;var d=this.dialog.hide();var f=d.name;var i=this.a;var k=this;if(f==""||f==null){if(i){var c=k.outwardHtml(i.innerHTML);i.parentNode.removeChild(i);b.insertHTML(c)}return}try{var j=b._doc;if(!i){i=j.createElement("a");i.id=f;i.name=f;i.title=f;i.className="anchor";i.innerHTML=k.placeholderImg;var g=b.getSelectedHTML();if(g){i.innerHTML+=g}if(Xinha.is_ie){range.pasteHTML(i.outerHTML)}else{b.insertNodeAtSelection(i)}}else{i.id=f;i.name=f;i.title=f;i.className="anchor"}}catch(h){}};