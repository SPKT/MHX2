/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function NoteServer(c){this.editor=c;var a=c.config;var b=this;a.registerButton({id:"insertscore",tooltip:this._lc("Insert GUIDO Music Notation"),image:c.imgURL("note.gif","NoteServer"),textMode:false,action:function(d){b.buttonPress(d)}});a.addToolbarElement("insertscore","insertimage",1)}NoteServer._pluginInfo={name:"NoteServer",version:"1.1",developer:"Richard Christophe",developer_url:"http://piano-go.chez.tiscali.fr/guido.html",c_owner:"Richard Christophe",sponsor:"",sponsor_url:"",license:"htmlArea"};NoteServer.prototype._lc=function(a){return Xinha._lc(a,"NoteServer")};NoteServer.prototype.buttonPress=function(a){a._popupDialog("plugin://NoteServer/codenote",function(b){if(!b){return false}else{IncludeGuido(a,b)}},null)};var noteserveraddress="clef.cs.ubc.ca";var htmlbase="/salieri/nview";var versionstring="";function GetGIFURL(b,c,d){b=escape(b);b=b.replace(/\//g,"%2F");if(!c){c="1.0"}if(!d){d="1"}var a="http://"+noteserveraddress+"/scripts/salieri"+versionstring+"/gifserv.pl?pagewidth=21&pageheight=29.7&zoomfactor="+c+"&pagesizeadjust=yes&outputformat=gif87&pagenum="+d+"&gmndata="+b;return a}function GetMIDIURL(b){b=escape(b);b=b.replace(/\//g,"%2F");var a="http://"+noteserveraddress+"/scripts/salieri"+versionstring+"/midserv.pl?gmndata="+b;return a}function GetAPPLETURL(b,c){b=escape(b);b=b.replace(/\//g,"%2F");var a='<applet code="NoteServerApplet" codebase="http://'+noteserveraddress+htmlbase+'/java"  width=700 height=300><param name=server value="'+noteserveraddress+'"><param name=serverVersion value="'+versionstring+'"><param name=zoomFactor value="'+c+'"><param name=pageWidth value="21"><param name=pageHeight value="29.7"><param name=gmn value="'+b+'"></applet>';return a}function IncludeGuido(b,e){if(!e.f_zoom){zoom=""}var d=GetGIFURL(e.f_code,e.f_zoom,"");var h=GetMIDIURL(e.f_code);var a="<br>";if(e.f_applet==false){if(((navigator.userAgent.toLowerCase().indexOf("msie")!=-1)&&(navigator.userAgent.toLowerCase().indexOf("opera")==-1))){b.focusEditor();b.insertHTML("<img src="+d+">")}else{img=new Image();img.src=d;var g=b._doc;var c=b._getSelection();var f=b._createRange(c);b._doc.execCommand("insertimage",false,img.src)}}else{var i=GetAPPLETURL(e.f_code,e.f_zoom);a=a+i+"<br>"}if(e.f_affcode){a=a+Xinha._lc("GUIDO Code","NoteServer")+" : "+e.f_code+"<br>"}if(e.f_midi){a=a+"<a href="+h+">"+Xinha._lc("MIDI File","NoteServer")+"</a> <br>"}b.focusEditor();b.insertHTML(a)}function IncludeGuidoStringAsApplet(a,c,d){c=escape(c);c=c.replace(/\//g,"%2F");var b='<applet codebase="http://'+noteserveraddress+htmlbase+'/java"\ncode="NoteServerApplet" width=480 height=230><PARAM NAME=server VALUE=\''+noteserveraddress+"'><PARAM NAME=serverVersion VALUE='"+versionstring+"'><PARAM NAME=zoomFactor VALUE='"+d+'\'><param name=pageWidth value="21"><param name=pageHeight value="29.7"><PARAM NAME=gmn VALUE=\''+c+"'></applet>";alert(b);a.focusEditor();a.insertHTML(b)};